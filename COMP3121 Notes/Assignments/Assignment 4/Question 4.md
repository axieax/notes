# COMP3121 Assignment 4 Question 4

Andrew Xie, z5317337

**Use max flow algorithm to solve the following problem. You are given a usual $n \times n$ chess board with $k$ white bishops on the board at the given cells $(a_i,b_i)$, ($1 \leq a_i, b_i\leq n, 1 \leq i \leq k$). You have to determine the largest number of black rooks you can place on the board so that no two rooks are in the same row or in the same column or are under the attack of any of the $k$​ bishops (recall that bishops go diagonally).**

A bipartite graph can be used to model the relationship between the set of row values $1 \leq i \leq n$​​​​​ and the set of column values $1 \leq j \leq n$​​ from the chess board​​​, where an edge from vertex $i$​​​​​ to vertex $j$​​​​​ exists if a black rook can be safely placed in cell $(i,j)$​​​​​ and not be under the attack by any of the $k$​​​​​​​​​​ white bishops. Unsafe squares can be found by creating a $n \times n$​​​​ matrix representing the chess board, and marking the squares which can be found in the diagonal paths spanning from each of the $k$​​​​​ bishops. There are at most $n$​​​​ squares to be marked for each of the four diagonal directions, so the total complexity of this step is $O(kn)$​​​. The edges to be added to the bipartite graph are the set of safe squares, which can be found by taking the traversing the matrix in $O(n^2)$​​​​​ time to find the unmarked squares. There are at most $O(n^2)$ safe squares or edges, and these edges can be found in $O(n^2 + kn)$​ time. 

Since we want to find the largest number of black rooks which can be placed so that no two rooks appear in the same row or column, the bipartite graph can be extended to become a flow network by adding a super source which connects to all the row values $i$​​​​, and a super sink connected from all the column values $j$​​​​​. The maximum flow of the network can be used to find the largest number of rooks which can be placed, whereby setting each edge in the network to have a capacity of 1 unit also enforces the unique row and column constraint such that there is only at most one augmented path for each row and column. The solution to the problem is thus the maximum flow of the network, and can be computed in $O(|E|\cdot f_{max})$​​​​​ time using the Ford-Fulkerson method, where $f_{max}$​​​​​​ is the maximum possible flow of the network. Since there is at least one white bishop, there are at most $n-1$​​​ unique rows and columns where black rooks can be placed, so this method has a worst case time complexity of $O(n^2 \cdot (n-1)) = O(n^3)$​​​​​​​​. ​​​The solution can thus be found in $O((kn)+(n^2+kn)+(n^3))=O(n^3+kn)$​​​ time. Since the number of white bishops $k$ is bounded by the number of cells on the chess board $n^2$​, the time complexity can be further simplified to be $O(n^3)$.

